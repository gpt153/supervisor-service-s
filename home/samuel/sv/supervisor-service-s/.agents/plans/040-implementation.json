{
  "epicId": "040",
  "projectName": "supervisor-service-s",
  "generated": "2026-01-22T13:31:28.709Z",
  "approach": "## Solution Approach for PS Health Monitoring System\n\nExternal health monitoring service that forces PS to report status every 10 minutes via tmux prompting. Tracks spawned subagents, detects stalls, monitors context usage, and triggers automated handoffs when context exceeds 85%. Enables truly autonomous long-running supervision sessions by preventing context exhaustion and spawn stalls.\n\n### Technical Approach\n\nThis feature will be implemented using the existing tech stack:\n- TypeScript\n\n### Code Conventions\n\n- Files: PascalCase\n- Classes: PascalCase\n- Functions: camelCase\n\n### Integration Points\n\n- API Endpoints (api): REST API endpoints for external communication\n- Service Layer (service): Business logic and service integrations\n",
  "phases": [
    {
      "name": "Setup",
      "description": "Create necessary types and structure",
      "tasks": [
        {
          "id": "040-setup-1",
          "title": "Define TypeScript interfaces and types",
          "description": "Create type definitions for new features",
          "files": [
            "src/types/040.ts"
          ],
          "prescriptiveInstructions": "Create TypeScript type definitions for PS Health Monitoring System.\n\nFollow these conventions:\n- Use PascalCase for interface names\n- Use SCREAMING_SNAKE_CASE for type constants\n- Export all public types\n\nStructure:\n1. Define main interfaces\n2. Define supporting types\n3. Export all types\n\nExample structure:\n```typescript\nexport interface MainType {\n  // Properties based on epic requirements\n}\n\nexport type SupportingType = string | number;\n\nexport const CONSTANT_VALUE = 'value' as const;\n```",
          "validations": [
            {
              "description": "TypeScript compilation succeeds",
              "command": "npm run build",
              "expectedOutput": "no errors",
              "failureAction": "retry"
            }
          ],
          "estimatedMinutes": 15
        }
      ],
      "dependencies": []
    },
    {
      "name": "Core Implementation",
      "description": "Implement main feature functionality",
      "tasks": [
        {
          "id": "040-core-1",
          "title": "Implement core functionality",
          "description": "External health monitoring service that forces PS to report status every 10 minutes via tmux prompting. Tracks spawned subagents, detects stalls, monitors context usage, and triggers automated handoffs when context exceeds 85%. Enables truly autonomous long-running supervision sessions by preventing context exhaustion and spawn stalls.",
          "files": [
            "src/040.ts"
          ],
          "prescriptiveInstructions": "Implement PS Health Monitoring System.\n\nRequirements:\nExternal health monitoring service that forces PS to report status every 10 minutes via tmux prompting. Tracks spawned subagents, detects stalls, monitors context usage, and triggers automated handoffs when context exceeds 85%. Enables truly autonomous long-running supervision sessions by preventing context exhaustion and spawn stalls.\n\nFollow these conventions:\n- File naming: PascalCase\n- Function naming: camelCase\n- Class naming: PascalCase\n\nIntegration points:\n- API Endpoints (api)\n- Service Layer (service)\n\nImplementation steps:\n1. Import required dependencies\n2. Define class/function structure\n3. Implement core logic\n4. Handle error cases\n5. Add JSDoc comments\n\nEnsure:\n- Type safety with TypeScript\n- Error handling\n- Clear function documentation",
          "validations": [
            {
              "description": "Code compiles without errors",
              "command": "npm run lint",
              "expectedOutput": "no errors",
              "failureAction": "retry"
            }
          ],
          "estimatedMinutes": 60
        }
      ],
      "dependencies": [
        "Setup"
      ]
    }
  ],
  "overallValidation": [
    {
      "description": "Full build succeeds",
      "command": "npm run build",
      "expectedOutput": "Build completed successfully",
      "failureAction": "retry"
    },
    {
      "description": "Linting passes",
      "command": "npm run lint",
      "expectedOutput": "No linting errors",
      "failureAction": "retry"
    }
  ],
  "acceptanceCriteria": [
    "Monitor service runs every 10 minutes without manual intervention",
    "All spawned subagents tracked in active_spawns table",
    "Stalled spawns (no output 15+ min) detected within 10 minutes",
    "PS reports context usage every 10 minutes via tmux prompting",
    "Context usage accurately parsed and stored (matches PS system warnings)",
    "Automated handoff triggered when context > 85%",
    "Handoff cycle completes: handoff file created → context cleared → work resumed",
    "PS session runs >24 hours without context exhaustion",
    "Zero mid-task context interruptions (all handoffs before 90%)",
    "Health check audit trail records 100% of prompts and responses",
    "Monitor survives PS restart (re-initializes session tracking)"
  ],
  "notes": [
    "Follow PascalCase file naming convention",
    "Use PascalCase for class names",
    "Follow PascalCase for file names and PascalCase for class names",
    "Consider integration with existing api, service layers",
    "Define TypeScript interfaces for new types",
    "Maintain strict type safety",
    "Existing pattern: Files use PascalCase naming convention",
    "Existing pattern: Strong typing with TypeScript interfaces and types"
  ]
}